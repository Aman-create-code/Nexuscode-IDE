<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>NexusCode IDE | GitHub Workspaces</title>
    <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/editor/editor.main.min.css">
    
    <style>
        :root {
            --activity-bg: #24292e;
            --sidebar-bg: #1b1f23;
            --editor-bg: #0d1117;
            --panel-bg: #0d1117;
            --status-bg: #21262d;
            --accent-blue: #58a6ff;
            --border: #30363d;
            --tab-active: #0d1117;
            --tab-inactive: #161b22;
            --text-main: #c9d1d9;
            --text-muted: #8b949e;
        }

        body, html { margin: 0; padding: 0; height: 100vh; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; background: var(--editor-bg); color: var(--text-main); }

        .app-container {
            display: grid;
            grid-template-columns: 48px 260px 1fr;
            grid-template-rows: 1fr 240px 22px;
            height: 100vh;
        }

        /* Activity Bar */
        .activity-bar {
            grid-row: 1 / 3;
            background: var(--activity-bg);
            border-right: 1px solid var(--border);
            display: flex; flex-direction: column; align-items: center; padding-top: 12px; gap: 18px;
        }
        .act-icon { width: 24px; height: 24px; color: var(--text-muted); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .act-icon.active { color: white; border-left: 2px solid var(--accent-blue); width: 46px; }

        /* Sidebar */
        .sidebar {
            grid-row: 1 / 3;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            display: flex; flex-direction: column;
        }
        .sidebar-header { padding: 10px 16px; font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; }
        .file-list { list-style: none; padding: 0; margin: 0; }
        .file { padding: 6px 16px; font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: var(--text-main); }
        .file:hover { background: #21262d; }
        .file.active { background: #2d333b; color: white; }

        /* Editor */
        .editor-area { display: flex; flex-direction: column; background: var(--editor-bg); }
        .tab-container { display: flex; background: var(--tab-inactive); height: 35px; border-bottom: 1px solid var(--border); }
        .tab { padding: 8px 16px; font-size: 12px; border-right: 1px solid var(--border); cursor: pointer; color: var(--text-muted); display: flex; align-items: center; gap: 8px; }
        .tab.active { background: var(--tab-active); color: white; border-top: 1px solid var(--accent-blue); }

        #monaco-editor { flex-grow: 1; }

        /* Panel (Terminal + Preview) */
        .panel-area {
            grid-column: 3 / 4;
            background: var(--panel-bg);
            border-top: 1px solid var(--border);
            display: grid; grid-template-columns: 1fr 1fr;
        }
        .terminal-box { border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .panel-nav { display: flex; gap: 15px; padding: 0 15px; font-size: 11px; height: 30px; align-items: center; border-bottom: 1px solid var(--border); color: var(--text-muted); }
        .panel-nav span.active { color: var(--accent-blue); font-weight: 600; }
        #console { flex-grow: 1; padding: 10px; font-family: monospace; font-size: 12px; overflow-y: auto; color: #7ee787; white-space: pre-wrap; }

        .preview-box { background: white; position: relative; }
        iframe { width: 100%; height: 100%; border: none; }
        .preview-label { position: absolute; top: 5px; right: 10px; font-size: 10px; color: #ccc; pointer-events: none; }

        /* Status Bar */
        .status-bar {
            grid-column: 1 / 4;
            background: var(--status-bg);
            border-top: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 12px; font-size: 12px; color: var(--text-muted);
        }
        .status-left { display: flex; align-items: center; gap: 10px; color: white; background: var(--accent-blue); padding: 0 10px; height: 100%; font-weight: 500; }
        .save-indicator { font-style: italic; font-size: 10px; margin-left: 10px; opacity: 0.7; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="activity-bar">
        <div class="act-icon active">üìÅ</div>
        <div class="act-icon">üîç</div>
        <div class="act-icon">üåø</div>
        <div class="act-icon">üõ†Ô∏è</div>
        <div style="flex-grow: 1;"></div>
        <div class="act-icon">‚öôÔ∏è</div>
    </div>

    <div class="sidebar">
        <div class="sidebar-header">Explorer</div>
        <ul class="file-list">
            <li class="file active" id="f-html" onclick="load('html')"><span>üìÑ</span> index.html</li>
            <li class="file" id="f-css" onclick="load('css')"><span>üé®</span> style.css</li>
            <li class="file" id="f-javascript" onclick="load('javascript')"><span>‚ö°</span> script.js</li>
        </ul>
    </div>

    <div class="editor-area">
        <div class="tab-container">
            <div class="tab active" id="active-tab-title">index.html</div>
            <div class="save-indicator" id="save-status">Vorgang gespeichert...</div>
        </div>
        <div id="monaco-editor"></div>
    </div>

    <div class="panel-area">
        <div class="terminal-box">
            <div class="panel-nav">
                <span>PROBLEMS</span>
                <span>OUTPUT</span>
                <span class="active">TERMINAL</span>
                <span>DEBUG CONSOLE</span>
            </div>
            <div id="console">> NexusCode Workspace v3.0 [Stable]<br>> Autosave aktiv.</div>
        </div>
        <div class="preview-box">
            <div class="preview-label">LIVE PREVIEW</div>
            <iframe id="preview-frame"></iframe>
        </div>
    </div>

    <footer class="status-bar">
        <div class="status-left">main*</div>
        <div style="flex-grow: 1; padding-left: 15px;">0 ‚ñ≥ 0 ‚äó  -- Ln 1, Col 1</div>
        <div>amancreatecode Copyright 2026</div>
    </footer>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.min.js"></script>
<script>
    let editor;
    let currentMode = 'html';
    
    // Standard-Projekt oder aus LocalStorage laden
    const defaultProject = {
        html: `<div class="card">\n  <h1>NexusCode IDE</h1>\n  <p>Dein Code wird automatisch gespeichert.</p>\n  <button id="btn">Klick mich</button>\n</div>`,
        css: `body { background: #0d1117; color: white; font-family: sans-serif; height: 100vh; display: flex; align-items: center; justify-content: center; margin: 0; }\n.card { text-align: center; border: 1px solid #30363d; padding: 40px; border-radius: 6px; background: #161b22; }\nbutton { background: #238636; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-top: 15px; }`,
        javascript: `document.getElementById('btn').onclick = () => {\n  console.log('Autosave funktioniert!');\n  alert('NexusCode IDE bereit!');\n};`
    };

    let project = JSON.parse(localStorage.getItem('nexus_project')) || defaultProject;

    require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs' }});
    require(['vs/editor/editor.main'], function() {
        editor = monaco.editor.create(document.getElementById('monaco-editor'), {
            value: project[currentMode],
            language: 'html',
            theme: 'vs-dark',
            automaticLayout: true,
            fontFamily: "'Fira Code', monospace",
            fontSize: 13,
            minimap: { enabled: true }
        });

        // Event: Speichern und Preview bei jeder √Ñnderung
        editor.onDidChangeModelContent(() => {
            saveAndRefresh();
        });

        updatePreview();
    });

    function saveAndRefresh() {
        project[currentMode] = editor.getValue();
        localStorage.setItem('nexus_project', JSON.stringify(project));
        
        const indicator = document.getElementById('save-status');
        indicator.innerText = "Speichere...";
        setTimeout(() => indicator.innerText = "Alle √Ñnderungen gespeichert", 500);
        
        updatePreview();
    }

    function load(file) {
        // Vorherigen Stand sichern
        project[currentMode] = editor.getValue();
        
        currentMode = file;
        document.getElementById('active-tab-title').innerText = file === 'javascript' ? 'script.js' : (file === 'css' ? 'style.css' : 'index.html');
        
        // UI Tabs/Sidebar anpassen
        document.querySelectorAll('.file').forEach(f => f.classList.remove('active'));
        document.getElementById('f-' + file).classList.add('active');

        // Monaco Sprache & Inhalt √§ndern
        monaco.editor.setModelLanguage(editor.getModel(), file === 'javascript' ? 'javascript' : file);
        editor.setValue(project[file]);
    }

    function updatePreview() {
        const frame = document.getElementById('preview-frame');
        const code = `<html><head><style>${project.css}</style></head><body>${project.html}<script>
            console.log = (m) => window.parent.postMessage(m, "*");
            try { ${project.javascript} } catch(e) { console.log("Error: " + e.message); }
        <\/script></body></html>`;
        frame.srcdoc = code;
    }

    window.onmessage = (e) => {
        const c = document.getElementById('console');
        c.innerHTML += `<br><span style="color:#58a6ff">‚ûú</span> ${e.data}`;
        c.scrollTop = c.scrollHeight;
    };
</script>
</body>
</html>
